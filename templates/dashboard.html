{% extends 'base.html' %}

{% block content %}
  <h2>Your Life Calendar</h2>

    <div name="add_event">
        <h3>Add a life event</h3>
        <form action="{% url 'dashboard' %}" method="post">
            {% csrf_token %}
            <label for="user_event_form.event_name">Event name:</label>
            {{ user_event_form.event_name }}<br>
            <label for="user_event_form.event_date">Event date:</label>
            {{ user_event_form.event_date }}<br>
            <button name="add_event_btn" type="submit">Add event</button><br>
            {{ user_event_form.event_date.errors }}
        </form>
    </div>

    <div class="grid">
        <table>
            {% for yr_num in years_passed %}
                <tr class="year-row past" id="year-{{ yr_num }}">
                    {% for week_no in full_year_weeks %}
                        {% if yr_num == event_year and week_no == event_week %}
                            <td class="week past event" id="{{ yr_num }}-{{ week_no }}" data-tooltip="{{ event_name }} — {{ event_date }}">{{ week_no }}</td>
                        {% else %}
                            <td class="week past" id="{{ yr_num }}-{{ week_no }}">{{ week_no }}</td>
                        {% endif %}
                    {% endfor %}
                </tr>
            {% endfor %}

            <tr class="year-row present" id="year-{{ current_year }}">
                {% for week_no in weeks_passed_this_yr %}
                    {% if current_year == event_year and week_no == event_week %}
                        <td class="week past event" id="{{ current_year }}-{{ week_no }}" data-tooltip="{{ event_name }} — {{ event_date }}">{{ week_no }}</td>
                    {% else %}
                        <td class="week past" id="{{ current_year }}-{{ week_no }}">{{ week_no }}</td>
                    {% endif %}
                {% endfor %}

                <td class="week present" id="{{ current_week }}">{{ current_week }}</td>

                {% for week_no in weeks_left_this_yr %}
                    {% if current_year == event_year and week_no == event_week %}
                        <td class="week future event" id="{{ current_year }}-{{ week_no }}" data-tooltip="{{ event_name }} — {{ event_date }}">{{ week_no }}</td>
                    {% else %}
                        <td class="week future" id="{{ current_year }}-{{ week_no }}">{{ week_no }}</td>
                    {% endif %}
                {% endfor %}
            </tr>

            {% for yr_num in future_years %}
                <tr class="year-row future" id="year-{{ yr_num }}">
                    {% for week_no in full_year_weeks %}
                        {% if yr_num == event_year and week_no == event_week %}
                            <td class="week future event" id="{{ yr_num }}-{{ week_no }}" data-tooltip="{{ event_name }} — {{ event_date }}">{{ week_no }}</td>
                        {% else %}
                            <td class="week future" id="{{ yr_num }}-{{ week_no }}">{{ week_no }}</td>
                        {% endif %}
                    {% endfor %}
                </tr>
            {% endfor %}
        </table>
    </div>
{% endblock content %}